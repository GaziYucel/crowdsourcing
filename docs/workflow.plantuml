@startuml
!theme cerulean-outline

skinparam backgroundColor white
skinparam handwritten false
skinparam defaultFontName Arial
skinparam actorStyle awesome
skinparam participantPadding 20
skinparam boxPadding 10

' Custom styles
skinparam sequence {
    ArrowColor #2D22DE
    ActorBorderColor #2D22DE
    LifeLineBorderColor #9931FC
    ParticipantBorderColor #2D22DE
    ParticipantBackgroundColor #F0F0FF
    BoxBorderColor #2D22DE
}

actor "Trusted Agent" as User #9931FC
participant GitHub #2D22DE
participant "CSV Validator" as Validator #4B0082
database "OpenCitations\nIndex/Meta" as OC #9931FC
database Zenodo #FF6B6B

title Crowdsourcing Workflow for OpenCitations

autonumber

== Issue Submission ==
User -> GitHub: Create issue with:\n1. "deposit" label\n2. Formatted title\n3. Metadata CSV\n4. Citations CSV

== Validation Phase ==
GitHub -> Validator: Trigger validation workflow
note right: Checks user authorization\nand data format

alt Invalid Data
    Validator --> GitHub: Add "invalid" label\nComment with validation errors
    GitHub --> User: Notify validation failure
else Unauthorized User
    Validator --> GitHub: Add "rejected" label
    GitHub --> User: Request contact with OpenCitations
else Valid Data
    Validator --> GitHub: Add "to be processed" label
end

== Processing Phase ==
group Monthly Processing
    GitHub -> OC: Process valid deposits
    activate OC
    OC -> OC: Ingest citation data\nand metadata
    OC --> GitHub: Add "done" label\nClose issue
    deactivate OC
end

== Archival Phase ==
group Monthly Archival
    OC -> Zenodo: Archive processed deposits
    note right: Preserves deposit history\nand provenance
end

@enduml